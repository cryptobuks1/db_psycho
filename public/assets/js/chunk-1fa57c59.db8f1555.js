(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1fa57c59"],{"3d85":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.current_step?n("div",{staticClass:"steps container no-padding"},[n("div",{staticClass:"steps-panel"},t._l(t.steps,function(e,s){return 0!==e["line_n"]?n("div",{staticClass:"step",class:{active:s===t.current_step_index,done:e["completed_l"]},on:{click:function(e){return t.switchStep(s)}}},[n("div",{staticClass:"step-text"},[n("h3",[t._v(t._s(e.fe_route_step_title))]),n("p",[t._v(t._s(e.fe_route_step_name))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:s===t.current_step_index,expression:"index === current_step_index"}]},[n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_edit.svg",alt:""}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:s!==t.current_step_index&&e["completed_l"],expression:"index !== current_step_index && step['completed_l']"}]},[n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_done.svg",alt:""}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:s!==t.current_step_index&&!e["completed_l"],expression:"index !== current_step_index && !step['completed_l']"}]},[n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_error.svg",alt:""}})])]):t._e()}),0),n("div",{staticClass:"steps__container"},[n("transition",{attrs:{name:"fade",appear:"",mode:"out-in"}},[n("router-view",{key:t.$bRoute.fullPath,attrs:{disable_inputs:t.disable_inputs,row_id_fe_route_step_object:t.current_step["row_id_fe_route_step_object"],controller_alias:t.$bRoute.matched[0].meta.controller_alias,step_l:"true"},on:{modelSaved:t.modelSaved}})],1)],1),t.current_step_index+1<=t.steps.length-1?n("div",{staticClass:"d-flex"},[n("div",{staticClass:"btn btn-empty left",on:{click:function(e){return t.switchStep(t.current_step_index-1)}}},[n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_arrow.svg",alt:""}}),t._v(" "+t._s(t.translations.Back)+"\n        ")]),n("div",{staticClass:"btn btn-empty "},[t._v(t._s(t.translations.Step+" ")+" "+t._s(t.current_step_index+1))]),n("div",{staticClass:"btn btn-empty right",on:{click:function(e){return t.switchStep(t.current_step_index+1)}}},[t._v(" "+t._s(t.translations.Forward+" ")+"\n            "),n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_arrow.svg",alt:""}})]),n("button",{staticClass:"btn btn-darkaccent",on:{click:t.closeStep}},[t._v(t._s(this.current_step_index===this.steps.length-2?t.translations.SendRequestForReview:t.translations.CloseStep)+"\n        ")])]):t._e()]):t._e()},i=[],r=(n("28a5"),n("a481"),n("96cf"),n("3b8d")),o=n("56d7"),a=function(t){Promise.all([n.e("chunk-2d21ad26"),n.e("chunk-48aa3d49")]).then(function(){t(n("57da"))}.bind(null,n)).catch(n.oe)},c=function(t){Promise.resolve().then(function(){t(n("2e90"))}.bind(null,n)).catch(n.oe)},u=function(t){Promise.all([n.e("chunk-2d21ad26"),n.e("chunk-17cd360c"),n.e("chunk-43e2e309"),n.e("chunk-0b169a3c")]).then(function(){t(n("ae8d"))}.bind(null,n)).catch(n.oe)},p=function(t){Promise.all([n.e("chunk-17cd360c"),n.e("chunk-535e1e9f")]).then(function(){t(n("05f8"))}.bind(null,n)).catch(n.oe)},l=function(t){n.e("chunk-6c498d20").then(function(){t(n("4a85"))}.bind(null,n)).catch(n.oe)},d=function(t){n.e("chunk-658d03ba").then(function(){t(n("66aa"))}.bind(null,n)).catch(n.oe)},_=function(t){n.e("chunk-8f4242e0").then(function(){t(n("3fb9"))}.bind(null,n)).catch(n.oe)},f=function(t){n.e("chunk-92947cf8").then(function(){t(n("7a37"))}.bind(null,n)).catch(n.oe)},h=function(t){n.e("chunk-477ec86b").then(function(){t(n("7697"))}.bind(null,n)).catch(n.oe)},b=function(t){Promise.resolve().then(function(){t(n("3d85"))}.bind(null,n)).catch(n.oe)},m=function(t){n.e("chunk-cddfb548").then(function(){t(n("8f33"))}.bind(null,n)).catch(n.oe)},x=function(t){n.e("chunk-639b25c0").then(function(){t(n("5bcb"))}.bind(null,n)).catch(n.oe)},g=function(t){n.e("chunk-a03ffc50").then(function(){t(n("3dfd8"))}.bind(null,n)).catch(n.oe)},w={data:function(){var t=this;return{steps:[],current_step_index:null,current_step:null,completed_l:null,steps_config:null,translations:null,disable_inputs:!1,izitoast_question_config:{timeout:2e4,close:!1,overlay:!0,toastOnce:!0,id:"question",zindex:999,index_to:null,step_is_completed:null,position:"center",buttons:[["<button><b>ДА</b></button>",function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n,s){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.steps_config.allow_editing_completed||!t.completed_l){e.next=5;break}return e.next=3,t.rollbackRequest();case 3:return e.next=5,t.loadSteps(!0);case 5:t.goToStep(t.izitoast_question_config.index_to,t.izitoast_question_config.step_is_completed),n.hide({transitionOut:"fadeOut"},s,"button");case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),!0],["<button>НЕТ</button>",function(t,e){t.hide({transitionOut:"fadeOut"},e,"button")}]],onClosing:function(t,e,n){}}}},methods:{setCurrentStep:function(){var t=this;this.steps.some(function(e,n){return!e.completed_l&&(t.current_step=e,t.current_step_index=n,t.$bRouter.replace(t.$bRoute.matched[0].path.replace(":"+t.$bRoute.matched[0].meta.id_field,t.$bRoute.params[t.$bRoute.matched[0].meta.id_field])+"/"+t.current_step.fe_route_step_code),!0)}),null==this.current_step_index&&(this.current_step_index=this.steps.length-1,this.current_step=this.steps[this.steps.length-1],this.$bRouter.replace(this.$bRoute.matched[0].path.replace(":"+this.$bRoute.matched[0].meta.id_field,this.$bRoute.params[this.$bRoute.matched[0].meta.id_field])+"/"+this.current_step.fe_route_step_code))},closeStep:function(){if(this.steps_config.close_in_order){var t=this.current_step_index;if(this.steps.some(function(e,n){return!e.completed_l&&n<t}))return void this.$toast.error("Закрытие шага не по порядку","",{position:"topRight"})}o["EventBus"].$emit("close_step")},modelSaved:function(){var t=this,e=this.$bRoute.params[this.$bRoute.meta.id_field];this.$http.post("admin/FeRoute/step/objects/closeStep",{fe_route_step_id:this.current_step.fe_route_step_id,row_id_fe_route_object:e,fe_route_id:this.current_step.fe_route_id}).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t.current_step_index!==t.steps.length-2){e.next=3;break}return e.next=3,t.finishRequest();case 3:t.loadSteps(!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},loadSteps:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post(this.$bRoute.matched[0].meta.route,{row_id_fe_route_object:this.$bRoute.params[this.$bRoute.meta.id_field],fe_route_id:this.$bRoute.matched[0].meta.id_route}).then(function(t){"new"===n.$bRoute.params[n.$bRoute.meta.id_field]&&(n.$bRoute.params[n.$bRoute.meta.id_field]=t.data.row_id_fe_route_object),n.steps=t.data.steps,n.completed_l=t.data.completed_l,n.steps_config=t.data.steps_config,n.translations=t.data.translations,e&&n.setCurrentStep()});case 2:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),switchStep:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!(e<0||e==this.steps.length-1)){t.next=2;break}return t.abrupt("return");case 2:if(this.steps_config.allow_editing_completed){t.next=4;break}return t.abrupt("return");case 4:if(n=this.steps[e].completed_l,!n){t.next=15;break}if(this.steps_config.allow_editing){t.next=8;break}return t.abrupt("return");case 8:if(!this.steps_config.use_modal_confirmation){t.next=13;break}return this.izitoast_question_config.index_to=e,this.izitoast_question_config.step_is_completed=n,this.$toast.question("Подтвердить?","",this.izitoast_question_config),t.abrupt("return");case 13:t.next=17;break;case 15:if(this.steps_config.allow_browsing){t.next=17;break}return t.abrupt("return");case 17:if(!this.steps_config.allow_editing_completed||!this.completed_l){t.next=22;break}return t.next=20,this.rollbackRequest();case 20:return t.next=22,this.loadSteps(!0);case 22:this.goToStep(e,n);case 23:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),rollbackSteps:function(t,e){var n=this,s=[this.current_step.fe_route_step_id];t&&(s=this.steps.filter(function(t){return t.line_n>=n.current_step.line_n&&0!=t.completed_l}).map(function(t){return t.fe_route_step_id})),this.$http.post("/admin/FeRoute/step/objects/rollbackStep",{fe_route_step_ids:s}).then(function(t){n.loadSteps(!1)}).then(function(t){n.current_step=n.steps[e]})},goToStep:function(t,e){this.current_step_index=t,this.current_step=this.steps[t];var n=this.$bRoute.path.split("/");n.splice(-1,1),n=n.join("/")+"/"+this.current_step.fe_route_step_code,this.$bRouter.push(n),e&&this.rollbackSteps(this.steps_config.multiple_rollback,t)},finishRequest:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("/admin/FeRoute/step/objects/update",{fe_route_id:this.$bRoute.matched[0].meta.id_route,row_id_fe_route_object:this.$bRoute.params[this.$bRoute.meta.id_field],completed_l:1}).then(function(t){}).catch(function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.$toast.error("Ошибка при закрытии заявки","",{position:"topRight"}),e.current_step_index=e.steps.length-2,e.current_step=e.steps[e.current_step_index],t.next=5,e.rollbackSteps(!1,e.steps.length-2);case 5:e.loadSteps(!0);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),rollbackRequest:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("/admin/FeRoute/step/objects/update",{fe_route_id:this.$bRoute.matched[0].meta.id_route,row_id_fe_route_object:this.$bRoute.params[this.$bRoute.meta.id_field],completed_l:0}).then(function(t){});case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){this.$STEPS=!0,this.loadSteps(!0)},updated:function(){this.imgtosvg()},components:{List:c,Home:a,Card:u,Report:l,Profile:d,Error:_,Document:f,TextPage:h,Steps:b,Info:m,RequestCard:p,AttachedFiles:x,Questionnaire:g}},v=w,k=(n("f8b9"),n("2877")),R=Object(k["a"])(v,s,i,!1,null,null,null);e["default"]=R.exports},"4a17":function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,":root{--accent:#e1002d;--bg-color:#fff;--base-color:#202a3d;--darkAccent:#a2001e;--tableHead:#788699}.fade-enter-active,.fade-leave-active{-webkit-transition:opacity .5s;transition:opacity .5s}.fade-enter,.fade-leave-to{opacity:0}.steps .steps__container{min-height:30rem;-webkit-transition:all .25s;transition:all .25s}.steps .steps-panel{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;padding:15px;padding-top:0}@media (max-width:540px){.steps .steps-panel{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}}.steps .steps-panel .step{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:16.5%;flex-basis:16.5%;border:1px solid #ced0da;border-right:none;padding:1rem;-webkit-transition:color .3s,background-color .3s,-webkit-box-shadow .3s;transition:color .3s,background-color .3s,-webkit-box-shadow .3s;transition:color .3s,background-color .3s,box-shadow .3s;transition:color .3s,background-color .3s,box-shadow .3s,-webkit-box-shadow .3s;cursor:pointer;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-shadow:inset 0 0 0 0 rgba(225,0,45,.19);box-shadow:inset 0 0 0 0 rgba(225,0,45,.19)}@media (max-width:540px){.steps .steps-panel .step{border-right:1px solid #ced0da}}.steps .steps-panel .step:last-of-type{border-right:1px solid #ced0da}.steps .steps-panel .step svg{display:block}.steps .steps-panel .step svg path{fill:#e1002d}.steps .steps-panel .step.active{background-color:var(--darkAccent);color:#fff}.steps .steps-panel .step.active svg{display:block}.steps .steps-panel .step.active svg path{fill:#fff}.steps .steps-panel .step.done svg path{fill:#008f62}.steps .steps-panel .step:hover{-webkit-box-shadow:inset 0 0 3px 1px rgba(225,0,45,.19);box-shadow:inset 0 0 3px 1px rgba(225,0,45,.19)}.steps .steps-panel .step-text{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.steps .steps-panel .step h3{font-weight:600;font-size:2rem}.steps .steps-panel .step p{font-size:1.3rem;margin-top:.4rem}.d-flex{-ms-flex-wrap:wrap;flex-wrap:wrap}.btn-empty,.d-flex{display:-webkit-box;display:-ms-flexbox;display:flex}.btn-empty{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.btn-empty svg{-webkit-box-flex:0;-ms-flex:0 0 1rem;flex:0 0 1rem}.btn-empty.left svg{-webkit-transform:rotate(90deg);transform:rotate(90deg);margin-right:.4545454545rem}.btn-empty.right svg{-webkit-transform:rotate(-90deg);transform:rotate(-90deg);margin-left:.4545454545rem}.btn-darkaccent{margin-left:auto}",""])},bd3e:function(t,e,n){var s=n("4a17");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=n("499e").default;i("1c431967",s,!0,{sourceMap:!1,shadowMode:!1})},f8b9:function(t,e,n){"use strict";var s=n("bd3e"),i=n.n(s);i.a}}]);
//# sourceMappingURL=chunk-1fa57c59.db8f1555.js.map