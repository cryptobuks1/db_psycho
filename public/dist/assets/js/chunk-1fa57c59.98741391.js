(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1fa57c59"],{"3d85":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.current_step?n("div",{staticClass:"steps container no-padding"},[n("div",{staticClass:"steps-panel"},e._l(e.steps,function(t,s){return 0!==t["line_n"]?n("div",{staticClass:"step",class:{active:s==e.current_step_index,done:t["completed_l"]},on:{click:function(t){return e.switchStep(s)}}},[n("div",{staticClass:"step-text"},[n("h3",[e._v(e._s(t.fe_route_step_title))]),n("p",[e._v(e._s(t.fe_route_step_name))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:s==e.current_step_index,expression:"index == current_step_index"}]},[n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_edit.svg",alt:""}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:s!=e.current_step_index&&t["completed_l"],expression:"index != current_step_index && step['completed_l']"}]},[n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_done.svg",alt:""}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:s!=e.current_step_index&&!t["completed_l"],expression:"index != current_step_index && !step['completed_l']"}]},[n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_error.svg",alt:""}})])]):e._e()}),0),n("div",{staticClass:"steps__container"},[n("transition",{attrs:{name:"fade",appear:"",mode:"out-in"}},[n("router-view",{key:e.$bRoute.fullPath,attrs:{disable_inputs:e.disable_inputs,row_id_fe_route_step_object:e.current_step["row_id_fe_route_step_object"],controller_alias:e.$bRoute.matched[0].meta.controller_alias,step_l:"true"},on:{modelSaved:e.modelSaved}})],1)],1),e.current_step_index+1<=e.steps.length-1?n("div",{staticClass:"d-flex"},[n("div",{staticClass:"btn btn-empty left",on:{click:function(t){return e.switchStep(e.current_step_index-1)}}},[n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_arrow.svg",alt:""}}),e._v("  "+e._s(e.translations.Back)+" ")]),n("div",{staticClass:"btn btn-empty "},[e._v(e._s(e.translations.Step+" ")+"  "+e._s(e.current_step_index+1)+" ")]),n("div",{staticClass:"btn btn-empty right",on:{click:function(t){return e.switchStep(e.current_step_index+1)}}},[e._v(" "+e._s(e.translations.Forward+" ")+"  "),n("img",{staticClass:"svg",attrs:{src:"/img/interfacerbl/rbl_arrow.svg",alt:""}})]),n("button",{staticClass:"btn btn-darkaccent",on:{click:e.closeStep}},[e._v(e._s(this.current_step_index===this.steps.length-2?e.translations.SendRequestForReview:e.translations.CloseStep)+" ")])]):e._e()]):e._e()},i=[],r=(n("28a5"),n("a481"),n("96cf"),n("3b8d")),o=n("56d7"),a=function(e){n.e("chunk-ff3ce5d6").then(function(){e(n("57da"))}.bind(null,n)).catch(n.oe)},c=function(e){Promise.all([n.e("chunk-8bd6b87a"),n.e("chunk-eef2ff3a")]).then(function(){e(n("2e90"))}.bind(null,n)).catch(n.oe)},u=function(e){Promise.all([n.e("chunk-8bd6b87a"),n.e("chunk-eef2ff3a"),n.e("chunk-3415c64a")]).then(function(){e(n("ae8d"))}.bind(null,n)).catch(n.oe)},p=function(e){Promise.all([n.e("chunk-8bd6b87a"),n.e("chunk-eef2ff3a"),n.e("chunk-6a6a2526")]).then(function(){e(n("05f8"))}.bind(null,n)).catch(n.oe)},l=function(e){n.e("chunk-6c498d20").then(function(){e(n("4a85"))}.bind(null,n)).catch(n.oe)},d=function(e){n.e("chunk-658d03ba").then(function(){e(n("66aa"))}.bind(null,n)).catch(n.oe)},f=function(e){n.e("chunk-8f4242e0").then(function(){e(n("3fb9"))}.bind(null,n)).catch(n.oe)},_=function(e){Promise.all([n.e("chunk-8bd6b87a"),n.e("chunk-eef2ff3a"),n.e("chunk-92947cf8")]).then(function(){e(n("7a37"))}.bind(null,n)).catch(n.oe)},h=function(e){n.e("chunk-477ec86b").then(function(){e(n("7697"))}.bind(null,n)).catch(n.oe)},b=function(e){Promise.resolve().then(function(){e(n("3d85"))}.bind(null,n)).catch(n.oe)},m=function(e){n.e("chunk-cddfb548").then(function(){e(n("8f33"))}.bind(null,n)).catch(n.oe)},x=function(e){Promise.all([n.e("chunk-8bd6b87a"),n.e("chunk-639b25c0")]).then(function(){e(n("5bcb"))}.bind(null,n)).catch(n.oe)},g={data:function(){var e=this;return{steps:[],current_step_index:null,current_step:null,completed_l:null,steps_config:null,translations:null,disable_inputs:!1,izitoast_question_config:{timeout:2e4,close:!1,overlay:!0,toastOnce:!0,id:"question",zindex:999,index_to:null,step_is_completed:null,position:"center",buttons:[["<button><b>ДА</b></button>",function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(n,s){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!e.steps_config.allow_editing_completed||!e.completed_l){t.next=5;break}return t.next=3,e.rollbackRequest();case 3:return t.next=5,e.loadSteps(!0);case 5:e.goToStep(e.izitoast_question_config.index_to,e.izitoast_question_config.step_is_completed),n.hide({transitionOut:"fadeOut"},s,"button");case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),!0],["<button>НЕТ</button>",function(e,t){e.hide({transitionOut:"fadeOut"},t,"button")}]],onClosing:function(e,t,n){}}}},methods:{setCurrentStep:function(){var e=this;this.steps.some(function(t,n){return!t.completed_l&&(e.current_step=t,e.current_step_index=n,e.$bRouter.replace(e.$bRoute.matched[0].path.replace(":"+e.$bRoute.matched[0].meta.id_field,e.$bRoute.params[e.$bRoute.matched[0].meta.id_field])+"/"+e.current_step.fe_route_step_code),!0)}),null==this.current_step_index&&(this.current_step_index=this.steps.length-1,this.current_step=this.steps[this.steps.length-1],this.$bRouter.replace(this.$bRoute.matched[0].path.replace(":"+this.$bRoute.matched[0].meta.id_field,this.$bRoute.params[this.$bRoute.matched[0].meta.id_field])+"/"+this.current_step.fe_route_step_code))},closeStep:function(){if(this.steps_config.close_in_order){var e=this.current_step_index;if(this.steps.some(function(t,n){return!t.completed_l&&n<e}))return void this.$toast.error("Закрытие шага не по порядку","",{position:"topRight"})}o["EventBus"].$emit("close_step")},modelSaved:function(){var e=this,t=this.$bRoute.params[this.$bRoute.meta.id_field];this.$http.post("/admin/FeRoute/step/objects/closeStep",{fe_route_step_id:this.current_step.fe_route_step_id,row_id_fe_route_object:t}).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e.current_step_index!==e.steps.length-2){t.next=3;break}return t.next=3,e.finishRequest();case 3:e.loadSteps(!0);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},loadSteps:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post(this.$bRoute.matched[0].meta.route,{row_id_fe_route_object:this.$bRoute.params[this.$bRoute.meta.id_field],fe_route_id:this.$bRoute.matched[0].meta.id_route}).then(function(e){"new"===n.$bRoute.params[n.$bRoute.meta.id_field]&&(n.$bRoute.params[n.$bRoute.meta.id_field]=e.data.row_id_fe_route_object),n.steps=e.data.steps,n.completed_l=e.data.completed_l,n.steps_config=e.data.steps_config,n.translations=e.data.translations,t&&n.setCurrentStep()});case 2:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),switchStep:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!(t<0||t==this.steps.length-1)){e.next=2;break}return e.abrupt("return");case 2:if(this.steps_config.allow_editing_completed){e.next=4;break}return e.abrupt("return");case 4:if(n=this.steps[t].completed_l,!n){e.next=15;break}if(this.steps_config.allow_editing){e.next=8;break}return e.abrupt("return");case 8:if(!this.steps_config.use_modal_confirmation){e.next=13;break}return this.izitoast_question_config.index_to=t,this.izitoast_question_config.step_is_completed=n,this.$toast.question("Подтвердить?","",this.izitoast_question_config),e.abrupt("return");case 13:e.next=17;break;case 15:if(this.steps_config.allow_browsing){e.next=17;break}return e.abrupt("return");case 17:if(!this.steps_config.allow_editing_completed||!this.completed_l){e.next=22;break}return e.next=20,this.rollbackRequest();case 20:return e.next=22,this.loadSteps(!0);case 22:this.goToStep(t,n);case 23:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),rollbackSteps:function(e,t){var n=this,s=[this.current_step.fe_route_step_id];e&&(s=this.steps.filter(function(e){return e.line_n>=n.current_step.line_n&&0!=e.completed_l}).map(function(e){return e.fe_route_step_id})),this.$http.post("/admin/FeRoute/step/objects/rollbackStep",{fe_route_step_ids:s}).then(function(e){n.loadSteps(!1)}).then(function(e){n.current_step=n.steps[t]})},goToStep:function(e,t){this.current_step_index=e,this.current_step=this.steps[e];var n=this.$bRoute.path.split("/");n.splice(-1,1),n=n.join("/")+"/"+this.current_step.fe_route_step_code,this.$bRouter.push(n),t&&this.rollbackSteps(this.steps_config.multiple_rollback,e)},finishRequest:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/admin/FeRoute/step/objects/update",{fe_route_id:this.$bRoute.matched[0].meta.id_route,row_id_fe_route_object:this.$bRoute.params[this.$bRoute.meta.id_field],completed_l:1}).then(function(e){}).catch(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.$toast.error("Ошибка при закрытии заявки","",{position:"topRight"}),t.current_step_index=t.steps.length-2,t.current_step=t.steps[t.current_step_index],e.next=5,t.rollbackSteps(!1,t.steps.length-2);case 5:t.loadSteps(!0);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),rollbackRequest:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/admin/FeRoute/step/objects/update",{fe_route_id:this.$bRoute.matched[0].meta.id_route,row_id_fe_route_object:this.$bRoute.params[this.$bRoute.meta.id_field],completed_l:0}).then(function(e){});case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){this.$STEPS=!0,this.loadSteps(!0)},updated:function(){this.imgtosvg()},components:{List:c,Home:a,Card:u,Report:l,Profile:d,Error:f,Document:_,TextPage:h,Steps:b,Info:m,RequestCard:p,AttachedFiles:x}},w=g,v=(n("f8b9"),n("2877")),k=Object(v["a"])(w,s,i,!1,null,null,null);t["default"]=k.exports},"4a17":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,":root{--accent:#e1002d;--bg-color:#fff;--base-color:#202a3d;--darkAccent:#a2001e;--tableHead:#788699}.fade-enter-active,.fade-leave-active{-webkit-transition:opacity .5s;transition:opacity .5s}.fade-enter,.fade-leave-to{opacity:0}.steps .steps__container{min-height:30rem;-webkit-transition:all .25s;transition:all .25s}.steps .steps-panel{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;padding:15px;padding-top:0}@media (max-width:540px){.steps .steps-panel{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}}.steps .steps-panel .step{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:16.5%;flex-basis:16.5%;border:1px solid #ced0da;border-right:none;padding:1rem;-webkit-transition:color .3s,background-color .3s,-webkit-box-shadow .3s;transition:color .3s,background-color .3s,-webkit-box-shadow .3s;transition:color .3s,background-color .3s,box-shadow .3s;transition:color .3s,background-color .3s,box-shadow .3s,-webkit-box-shadow .3s;cursor:pointer;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-shadow:inset 0 0 0 0 rgba(225,0,45,.19);box-shadow:inset 0 0 0 0 rgba(225,0,45,.19)}@media (max-width:540px){.steps .steps-panel .step{border-right:1px solid #ced0da}}.steps .steps-panel .step:last-of-type{border-right:1px solid #ced0da}.steps .steps-panel .step svg{display:block}.steps .steps-panel .step svg path{fill:#e1002d}.steps .steps-panel .step.active{background-color:var(--darkAccent);color:#fff}.steps .steps-panel .step.active svg{display:block}.steps .steps-panel .step.active svg path{fill:#fff}.steps .steps-panel .step.done svg path{fill:#008f62}.steps .steps-panel .step:hover{-webkit-box-shadow:inset 0 0 3px 1px rgba(225,0,45,.19);box-shadow:inset 0 0 3px 1px rgba(225,0,45,.19)}.steps .steps-panel .step-text{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.steps .steps-panel .step h3{font-weight:600;font-size:2rem}.steps .steps-panel .step p{font-size:1.3rem;margin-top:.4rem}.d-flex{-ms-flex-wrap:wrap;flex-wrap:wrap}.btn-empty,.d-flex{display:-webkit-box;display:-ms-flexbox;display:flex}.btn-empty{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.btn-empty svg{-webkit-box-flex:0;-ms-flex:0 0 1rem;flex:0 0 1rem}.btn-empty.left svg{-webkit-transform:rotate(90deg);transform:rotate(90deg);margin-right:.4545454545rem}.btn-empty.right svg{-webkit-transform:rotate(-90deg);transform:rotate(-90deg);margin-left:.4545454545rem}.btn-darkaccent{margin-left:auto}",""])},bd3e:function(e,t,n){var s=n("4a17");"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var i=n("499e").default;i("1c431967",s,!0,{sourceMap:!1,shadowMode:!1})},f8b9:function(e,t,n){"use strict";var s=n("bd3e"),i=n.n(s);i.a}}]);
//# sourceMappingURL=chunk-1fa57c59.98741391.js.map